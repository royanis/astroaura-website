---
layout: default
title: Test IPGeolocation.io API Direct
---

<div class="container">
  <h1>IPGeolocation.io API Direct Test</h1>
  
  <div>
    <label for="testQuery">Enter location to test:</label>
    <input type="text" id="testQuery" value="New York" placeholder="Enter location...">
    <button onclick="testDirectAPI()">Test Direct API</button>
  </div>
  
  <div id="results" style="margin-top: 20px;">
    <!-- Results will appear here -->
  </div>
  
  <div id="console" style="margin-top: 20px; background: #f5f5f5; padding: 10px; border-radius: 5px; font-family: monospace; font-size: 12px; white-space: pre-wrap; max-height: 400px; overflow-y: auto;">
    <!-- Console logs will appear here -->
  </div>
</div>

<script>
const API_KEY = '1c355e807b2d45d09aa5d149e5e35b53';
const consoleDiv = document.getElementById('console');

// Override console methods to display in page
const originalLog = console.log;
const originalWarn = console.warn;
const originalError = console.error;

console.log = function(...args) {
  originalLog.apply(console, args);
  consoleDiv.innerHTML += '[LOG] ' + args.join(' ') + '\n';
  consoleDiv.scrollTop = consoleDiv.scrollHeight;
};

console.warn = function(...args) {
  originalWarn.apply(console, args);
  consoleDiv.innerHTML += '[WARN] ' + args.join(' ') + '\n';
  consoleDiv.scrollTop = consoleDiv.scrollHeight;
};

console.error = function(...args) {
  originalError.apply(console, args);
  consoleDiv.innerHTML += '[ERROR] ' + args.join(' ') + '\n';
  consoleDiv.scrollTop = consoleDiv.scrollHeight;
};

async function testDirectAPI() {
  const query = document.getElementById('testQuery').value;
  const resultsDiv = document.getElementById('results');
  
  console.log('=== Testing IPGeolocation.io Direct API ===');
  console.log('Query:', query);
  console.log('API Key:', API_KEY.substring(0, 8) + '...');
  
  resultsDiv.innerHTML = '<p>Testing API...</p>';
  
  // Test different possible endpoint formats
  const endpointTests = [
    {
      name: 'Standard Geocoding',
      url: `https://api.ipgeolocation.io/geocoding?apiKey=${API_KEY}&q=${encodeURIComponent(query)}`
    },
    {
      name: 'With Format JSON',
      url: `https://api.ipgeolocation.io/geocoding?apiKey=${API_KEY}&q=${encodeURIComponent(query)}&format=json`
    },
    {
      name: 'Alternative Endpoint',
      url: `https://api.ipgeolocation.io/geo?apiKey=${API_KEY}&q=${encodeURIComponent(query)}`
    }
  ];
  
  for (const test of endpointTests) {
    try {
      console.log(`\n--- Testing: ${test.name} ---`);
      console.log('URL:', test.url);
      
      const response = await fetch(test.url, {
        method: 'GET',
        headers: {
          'Accept': 'application/json',
          'User-Agent': 'AstroAura-Test/1.0'
        }
      });
      
      console.log('Response Status:', response.status, response.statusText);
      console.log('Response Headers:', Array.from(response.headers.entries()));
      
      if (response.ok) {
        const data = await response.json();
        console.log('Response Data:', JSON.stringify(data, null, 2));
        
        // Show successful result
        resultsDiv.innerHTML = `
          <h3>✅ Success with ${test.name}</h3>
          <pre>${JSON.stringify(data, null, 2)}</pre>
        `;
        
        return; // Stop testing on first success
        
      } else {
        const errorText = await response.text();
        console.error('Error Response:', errorText);
      }
      
    } catch (error) {
      console.error(`Error testing ${test.name}:`, error.message);
    }
  }
  
  // If we get here, all tests failed
  resultsDiv.innerHTML = '<p>❌ All API endpoint tests failed. Check console for details.</p>';
  console.log('\n=== All tests completed ===');
}

// Test on page load
document.addEventListener('DOMContentLoaded', () => {
  console.log('Page loaded. Click "Test Direct API" to test the IPGeolocation.io API.');
  console.log('API Key loaded:', API_KEY ? 'Yes' : 'No');
});
</script>